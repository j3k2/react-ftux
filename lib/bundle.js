'use strict';Object.defineProperty(exports,'__esModule',{value:!0});function _interopDefault(a){return a&&'object'==typeof a&&'default'in a?a['default']:a}var ee=_interopDefault(require('wolfy87-eventemitter')),React=_interopDefault(require('react')),styled=require('styled-components'),styled__default=_interopDefault(styled);function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function');a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a}function _possibleConstructorReturn(a,b){return b&&('object'==typeof b||'function'==typeof b)?b:_assertThisInitialized(a)}function _taggedTemplateLiteral(a,b){return b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}}))}var events={END_FTUX:'END_FTUX',INCREASE_STEP:'INCREASE_STEP',DECREASE_STEP:'DECREASE_STEP',UPDATE_FTUX:'UPDATE_FTUX'},eventEmitter=new ee,ftuxStore={},ReactFtux=/*#__PURE__*/function(a){function b(a){var c;return _classCallCheck(this,b),c=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a)),_defineProperty(_assertThisInitialized(c),'increaseStep',function(){var a=ftuxStore.currentStep+1;ftuxStore.currentStep=a,eventEmitter.trigger(events.UPDATE_FTUX,[ftuxStore])}),_defineProperty(_assertThisInitialized(c),'decreaseStep',function(){var a=0<ftuxStore.currentStep-1?ftuxStore.currentStep-1:0;ftuxStore.currentStep=a,eventEmitter.trigger(events.UPDATE_FTUX,[ftuxStore])}),_defineProperty(_assertThisInitialized(c),'keydownHandler',function(a){('ArrowLeft'===a.key||'Backspace'===a.key)&&c.decreaseStep(),('ArrowRight'===a.key||'Enter'===a.key)&&(ftuxStore.currentStep<c.props.total-1?c.increaseStep():eventEmitter.trigger(events.END_FTUX)),'Escape'===a.key&&eventEmitter.trigger(events.END_FTUX)}),_defineProperty(_assertThisInitialized(c),'init',function(){ftuxStore.currentStep=0,eventEmitter.trigger(events.UPDATE_FTUX,[ftuxStore])}),ftuxStore.ftuxProps=a,c.props.tooltipSettings&&c.props.tooltipSettings.disableKeydownListener||window.addEventListener('keydown',c.keydownHandler),eventEmitter.on(events.INCREASE_STEP,function(){c.increaseStep()}),eventEmitter.on(events.DECREASE_STEP,function(){c.decreaseStep()}),eventEmitter.on(events.END_FTUX,function(){c.props.ftuxEnd&&c.props.ftuxEnd()}),c.props.disable||c.init(),c}return _inherits(b,a),_createClass(b,[{key:'componentDidUpdate',value:function(){this.props.disable?eventEmitter.trigger(events.END_FTUX):this.init()}},{key:'componentWillUnmount',value:function(){this.props.tooltipSettings&&this.props.tooltipSettings.disableKeydownListener||window.removeEventListener('keydown',this.keydownHandler),eventEmitter.off(events.INCREASE_STEP),eventEmitter.off(events.DECREASE_STEP),eventEmitter.off(events.END_FTUX),eventEmitter.off(events.UPDATE_FTUX)}},{key:'render',value:function(){return null}}]),b}(React.Component);function _templateObject5(){var a=_taggedTemplateLiteral(['\n  border-top: 8px solid transparent; \n  border-bottom: 8px solid transparent;\n  border-left: 16px solid ',';  \n  right: -16px;\n']);return _templateObject5=function(){return a},a}function _templateObject4(){var a=_taggedTemplateLiteral(['\n  border-top: 8px solid transparent; \n  border-bottom: 8px solid transparent;\n  border-right: 16px solid ','; \n  left: -16px;\n']);return _templateObject4=function(){return a},a}function _templateObject3(){var a=_taggedTemplateLiteral(['\n  border-left: 8px solid transparent; \n  border-right: 8px solid transparent; \n  border-top: 16px solid ',';\n  top: 100%;\n']);return _templateObject3=function(){return a},a}function _templateObject2(){var a=_taggedTemplateLiteral(['\n  border-left: 8px solid transparent;\n  border-right: 8px solid transparent;\n  border-bottom: 16px solid ',';\n  top: -16px;\n']);return _templateObject2=function(){return a},a}function _templateObject(){var a=_taggedTemplateLiteral(['\n  width: 0px;\n  height: 0px;\n  position: absolute;\n']);return _templateObject=function(){return a},a}var PointerBase=styled__default.div(_templateObject()),PointerAbove=styled__default(PointerBase)(_templateObject2(),function(a){return a.backgroundColor}),PointerBelow=styled__default(PointerBase)(_templateObject3(),function(a){return a.backgroundColor}),PointerLeft=styled__default(PointerBase)(_templateObject4(),function(a){return a.backgroundColor}),PointerRight=styled__default(PointerBase)(_templateObject5(),function(a){return a.backgroundColor});function TooltipPointer(a){return React.createElement(React.Fragment,null,'above'===a.pointerDirection?React.createElement(PointerAbove,{backgroundColor:a.backgroundColor}):null,'below'===a.pointerDirection?React.createElement(PointerBelow,{backgroundColor:a.backgroundColor}):null,'left'===a.pointerDirection?React.createElement(PointerLeft,{backgroundColor:a.backgroundColor}):null,'right'===a.pointerDirection?React.createElement(PointerRight,{backgroundColor:a.backgroundColor}):null,a.pointerDirection?null:React.createElement(PointerAbove,{backgroundColor:a.backgroundColor}))}function _templateObject$1(){var a=_taggedTemplateLiteral(['\n  font: ',';\n  margin: 4px;\n  width: 64px;\n  height: 32px;\n  background-color: ',';\n  border: solid 1px ',';\n  border-radius: 5px;\n  color: ',';\n  :hover{\n    cursor: pointer;\n    color: ',';\n    border-color: ',';\n  }\n']);return _templateObject$1=function(){return a},a}var StyledButton=styled__default.button(_templateObject$1(),function(a){return a.buttonFontStyle},function(a){return a.backgroundColor},function(a){return a.foregroundColor},function(a){return a.foregroundColor},function(a){return a.highlightColor},function(a){return a.highlightColor});function TooltipButtons(a){return React.createElement('div',{style:{float:'right',paddingTop:10}},!a.tooltipSettings.first&&React.createElement(StyledButton,{buttonFontStyle:a.tooltipSettings.fontStyle,backgroundColor:a.tooltipSettings.backgroundColor,foregroundColor:a.tooltipSettings.foregroundColor,highlightColor:a.tooltipSettings.highlightColor,onClick:a.decreaseStep},a.tooltipSettings.prevLabel),!a.tooltipSettings.last&&React.createElement(StyledButton,{buttonFontStyle:a.tooltipSettings.fontStyle,backgroundColor:a.tooltipSettings.backgroundColor,foregroundColor:a.tooltipSettings.foregroundColor,highlightColor:a.tooltipSettings.highlightColor,onClick:a.increaseStep},a.tooltipSettings.nextLabel),a.tooltipSettings.last&&React.createElement(StyledButton,{buttonFontStyle:a.tooltipSettings.fontStyle,backgroundColor:a.tooltipSettings.backgroundColor,foregroundColor:a.tooltipSettings.foregroundColor,highlightColor:a.tooltipSettings.highlightColor,onClick:a.endFtux},a.tooltipSettings.doneLabel))}function _templateObject3$1(){var a=_taggedTemplateLiteral(['\n  all: initial;\n  padding: 20px;\n  position: fixed;\n  border-radius: 5px;\n  display: block;\n  animation: ',' ',' ease-in;\n']);return _templateObject3$1=function(){return a},a}function _templateObject2$1(){var a=_taggedTemplateLiteral(['\n  from {\n    opacity: 0;\n  }\n\n  to {\n    opacity: 1;\n  }\n']);return _templateObject2$1=function(){return a},a}function _templateObject$2(){var a=_taggedTemplateLiteral(['\n  :hover{\n    cursor: pointer;\n    color: ',';\n  }\n']);return _templateObject$2=function(){return a},a}var CloseButton=styled__default.span(_templateObject$2(),function(a){return a.highlightColor}),opacityAnimation=styled.keyframes(_templateObject2$1()),StyledTooltipBody=styled__default.div(_templateObject3$1(),opacityAnimation,function(a){return a.animationDuration});function TooltipBody(a){return React.createElement(StyledTooltipBody,{animationDuration:a.tooltipSettings.animationDuration+'s',style:Object.assign({},a.tooltipSettings.style,{pointerEvents:a.display?'auto':'none',top:a.tooltipSettings.offsetTop,left:a.tooltipSettings.offsetLeft,bottom:a.tooltipSettings.offsetBottom,right:a.tooltipSettings.offsetRight,backgroundColor:a.tooltipSettings.backgroundColor,color:a.tooltipSettings.foregroundColor,font:a.tooltipSettings.fontStyle,width:a.tooltipSettings.tooltipWidth,minWidth:a.tooltipSettings.tooltipWidth})},a.children,React.createElement(CloseButton,{style:{position:'absolute',top:4,right:6,fontSize:16,display:a.tooltipSettings.disableCloseButton?'none':null},highlightColor:a.tooltipSettings.highlightColor,onClick:a.endFtux},'\u2715'))}var ReactFtuxTooltip=/*#__PURE__*/function(a){function b(a){var c;return _classCallCheck(this,b),c=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a)),_defineProperty(_assertThisInitialized(c),'triggerEndFtux',function(){eventEmitter.trigger(events.END_FTUX)}),_defineProperty(_assertThisInitialized(c),'triggerIncreaseStep',function(){eventEmitter.trigger(events.INCREASE_STEP)}),_defineProperty(_assertThisInitialized(c),'triggerDecreaseStep',function(){eventEmitter.trigger(events.DECREASE_STEP)}),_defineProperty(_assertThisInitialized(c),'initializeTooltip',function(){c.tooltipSettings={first:0===c.props.step,last:ftuxStore.ftuxProps&&c.props.step===ftuxStore.ftuxProps.total-1,// Default values:
prevLabel:'Prev',doneLabel:'Done',nextLabel:'Next',animationDuration:.4,tooltipWidth:400,backgroundColor:'black',foregroundColor:'white',highlightColor:'grey',fontStyle:'14px Lato, Helvetica, Arial, sans-serif'},ftuxStore.ftuxProps.tooltipSettings&&(c.tooltipSettings=Object.assign(c.tooltipSettings,ftuxStore.ftuxProps.tooltipSettings))}),_defineProperty(_assertThisInitialized(c),'setPosition',function(){c.props.pointerDirection&&'above'!==c.props.pointerDirection||(c.tooltipSettings.offsetTop=c.tooltipRef.nextSibling.offsetHeight+16+(c.props.offsetTop||0),c.props.offsetLeft&&(c.tooltipSettings.offsetLeft=c.props.offsetLeft)),'left'===c.props.pointerDirection&&(c.tooltipSettings.offsetLeft=c.tooltipRef.nextSibling.offsetWidth+16+(c.props.offsetLeft||0),c.props.offsetTop&&(c.tooltipSettings.offsetTop=c.props.offsetTop)),'below'===c.props.pointerDirection&&(c.tooltipSettings.offsetBottom=16+(-c.props.offsetTop||0),c.props.offsetLeft&&(c.tooltipSettings.offsetLeft=c.props.offsetLeft)),'right'===c.props.pointerDirection&&(c.tooltipSettings.offsetRight=16+(-c.props.offsetLeft||0),c.props.offsetTop&&(c.tooltipSettings.offsetTop=c.props.offsetTop))}),_defineProperty(_assertThisInitialized(c),'updateTooltipState',function(a){c.props.step===a.currentStep?(c.props.scrollTo&&window.scrollTo(0,c.tooltipRef.offsetTop),c.props.scrollToTop&&window.scrollTo(0,0),c.setState({display:!0})):c.setState({display:!1})}),_defineProperty(_assertThisInitialized(c),'setTooltipRef',function(a){c.tooltipRef=a}),c.state={display:!1},c.initializeTooltip(),c}return _inherits(b,a),_createClass(b,[{key:'componentDidMount',value:function(){var a=this;eventEmitter.on(events.UPDATE_FTUX,function(b){a.updateTooltipState(b)}),eventEmitter.on(events.END_FTUX,function(){a.updateTooltipState({currentStep:null})}),eventEmitter.trigger(events.UPDATE_FTUX,[ftuxStore]),this.setPosition()}},{key:'componentWillUnmount',value:function(){eventEmitter.off(events.END_FTUX),eventEmitter.off(events.UPDATE_FTUX)}},{key:'render',value:function(){return React.createElement('div',{ref:this.setTooltipRef,style:{transform:'scale(1)',zIndex:void 0===this.props.zIndex?'auto':this.props.zIndex}},this.state.display&&React.createElement(TooltipBody,{tooltipSettings:this.tooltipSettings,display:this.state.display,endFtux:this.triggerEndFtux},React.createElement(TooltipPointer,{pointerDirection:this.props.pointerDirection,backgroundColor:this.tooltipSettings.backgroundColor}),React.createElement('div',{style:{display:'block',padding:10}},this.props.children),React.createElement(TooltipButtons,{tooltipSettings:this.tooltipSettings,increaseStep:this.triggerIncreaseStep,decreaseStep:this.triggerDecreaseStep,endFtux:this.triggerEndFtux})))}}]),b}(React.Component);exports.ReactFtux=ReactFtux,exports.ReactFtuxTooltip=ReactFtuxTooltip;
